<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GeoFS Private Flight Simulator + Source Downloader</title>
  <style>
    html, body, #cesiumContainer {
      margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000;
    }
    #download-status {
      position: fixed; bottom: 10px; left: 10px; color: #0f0; font-family: monospace;
      background: rgba(0,0,0,0.7); padding: 5px 10px; border-radius: 4px;
      z-index: 9999;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>
  <div id="download-status">Downloading GeoFS source...</div>

  <!-- Set Cesium base URL -->
  <script>
    window.CESIUM_BASE_URL = 'https://www.geo-fs.com/js/Cesium/build/';
  </script>

  <!-- Load Cesium core -->
  <script src="https://www.geo-fs.com/js/Cesium/build/Cesium.js"></script>

  <!-- Load GeoFS scripts -->
  <script src="https://www.geo-fs.com/js/commonJS.js"></script>
  <script src="https://www.geo-fs.com/js/geofs.js"></script>
  <script src="https://www.geo-fs.com/js/loader.js"></script>

  <script>
    window.addEventListener('load', () => {
      // Initialize GeoFS in private mode (no multiplayer)
      if (window.geofs && geofs.init) {
        geofs.init({
          containerId: 'cesiumContainer',
          assetsBaseUrl: 'https://www.geo-fs.com/',
          multiplayerServerUrl: null,
          maxPlayers: 3
        });
      } else {
        console.error('GeoFS scripts failed to load.');
      }

      // Fetch the full live GeoFS source and auto-download as index.html
      fetch('https://www.geo-fs.com/geofs.php?v=3.9')
        .then(r => r.text())
        .then(text => {
          const blob = new Blob([text], {type: 'text/html'});
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'index.html';
          document.body.appendChild(a);
          a.click();
          a.remove();
          URL.revokeObjectURL(url);
          document.getElementById('download-status').textContent = 'GeoFS source downloaded!';
          setTimeout(() => {
            document.getElementById('download-status').style.display = 'none';
          }, 3000);
        })
        .catch(e => {
          console.error('Failed to fetch GeoFS source:', e);
          document.getElementById('download-status').textContent = 'Failed to download GeoFS source.';
        });
    });
  </script>
</body>
</html>
